# Design Pattern / 設計方式 #

## Over-design ##
在設計你的 API 過程中，需要瞭解到通用性 (general) 以及一致性 (consistent)。
另外也需要考慮到是否有過度設計 (over-design) 的狀況發生：像是資料的獲取方式 (getter)
回傳資料的格式有很多種。然而為了滿足各方面的需求，而設計出各種可能的回傳格式，
這就稱之為過度設計。e.g.

+ getDataRaw (回傳 raw data，也就是 array)
+ getDataJson (回傳格式為 json)

## Check Status ##
在檢查狀態的時候可能會遇到非同步 (asynchronous) 的狀況，像是：觸發之後需要等一段時間才知道結果，
設計上就需要考量合理的等待時間 (threshold) 與即時性 (on-time)：

+ hardcode 寫死一個等待時間是不合理的，彈性降低也容易有不需要的等待時間。
+ 沒有終止條件是不合理的，無限制地等待會造成系統不會中止。
+ 頻繁的檢查是不合理的，檢查邏輯會變成是一個 busy-loop，要善用 sleep 來釋放 CPU 資源。

## Object Layout / 物件組成 ##
另一個典型的問題在於如何決定物件內容的組成。以 JSON 為例，除了基本元素外最常使用的就是
object/物件 (key-value based) 與 array/陣列。為了存取方便與使用流程，應該將有關聯的屬性放在一起，
並且用一個物件包裝起來，像是：

	:::json
	{
		"data": [{
			"MAC": "00:11:22:33:44:55",
				"ID": 1,
				"serial": "0012345678"
		}, {
			"MAC": "00:11:22:33:44:56",
			"ID": 2,
			"serial": "0012345679"
		}, {
			"MAC": "00:11:22:33:44:57",
			"ID": 3,
			"serial": "0012345680"
		}]
	}

這種設計中，一個 JSON 內容包含了一個最大的物件 `data` 並且他指向一個陣列，陣列中包含了若干物件。
每一個物件都代表著一個邏輯完整的機器，每一個都帶有共同的屬性 (key)。然而，不要為了減少 JSON
本身的大小 (假如用字串來看的話)，而將 JSON 的內容改用以下的方式儲存：

	:::json
	{"MAC": [
		"00:11:22:33:44:55",
		"00:11:22:33:44:56",
		"00:11:22:33:44:57"
	], "ID": [
		1,
		2,
		3
	], "serial": [
		"0012345678",
		"0012345679",
		"0012345680"
	]}

